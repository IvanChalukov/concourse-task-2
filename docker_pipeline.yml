resources:
- name: scripts
  type: git
  source:
    uri: https://github.com/IvanChalukov/concourse-tasks.git
    branch: task-5
    git_config:
    - name: safe.directory
      value: '*'

- name: every-5min
  type: time
  icon: clock-outline
  source:
    interval: 300s

jobs:
- name: docker-pipeline-job
  plan:
  - get: every-5min
    trigger: true
  - get: scripts
    trigger: true
  - task: docker-pipeline-task
    config:
      platform: linux
      image_resource:
        source:
          repository: ichalukov/sample_image
          tag: latest
        type: registry-image
      inputs:
      - name: scripts
      outputs:
      # to pass the commit to the following steps specify
      # the "scripts" as an output as well
      - name: scripts
      run:
        path: /bin/sh
        args:
        - -c
        - |
          cd scripts
          ./print.sh
          git commit -am "Update greeted.txt"
  # push commit
  - put: scripts
    params:
      repository: scripts